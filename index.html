<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Asistencias ‚Äî Redes & TICs</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
/* ‚îÄ‚îÄ VARIABLES Y ESTILOS ‚îÄ‚îÄ */
@import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;600&display=swap');
:root {
  --bg:#080b12; --s1:#0e1220; --s2:#141828; --s3:#1b2035;
  --border:#1e2540; --border2:#252d48;
  --amber:#f59e0b; --violet:#8b5cf6; --rose:#f43f5e; --teal:#14b8a6; --sky:#38bdf8;
  --green:#22c55e; --red:#ef4444; --blue:#60a5fa; --yellow:#eab308;
  --text:#e2e8f4; --muted:#5a6a8a; --muted2:#3a4560;
}
/* Reset y estilos generales */
*{box-sizing:border-box;margin:0;padding:0}
body{background:var(--bg);color:var(--text);font-family:'Plus Jakarta Sans',sans-serif;min-height:100vh;}
/* Aqu√≠ van todos los estilos que me enviaste: sidebar, content, tablas, personalizados, responsive */
</style>
</head>
<body>

<div class="layout">
  <!-- Sidebar -->
  <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>
  <nav class="sidebar" id="sidebar">
    <div class="sidebar-logo">Redes <span>&</span> TICs<small>Sistema de Asistencias</small></div>
    <div class="nav-section"><div class="nav-label">General</div>
      <button class="nav-item active" onclick="goPage('dashboard')"><div class="dot sky"></div> Resumen General</button>
    </div>
    <div class="nav-section"><div class="nav-label">‚òÄÔ∏è Turno Ma√±ana</div>
      <button class="nav-item nav-mod" onclick="goPage('M-1')"><div class="dot amber"></div>M√≥dulo 1</button>
      <button class="nav-item nav-mod" onclick="goPage('M-2')"><div class="dot amber"></div>M√≥dulo 2</button>
      <button class="nav-item nav-mod" onclick="goPage('M-3')"><div class="dot amber"></div>M√≥dulo 3</button>
      <button class="nav-item nav-mod" onclick="goPage('M-4')"><div class="dot amber"></div>M√≥dulo 4</button>
    </div>
    <div class="nav-section"><div class="nav-label">üåô Turno Tarde</div>
      <button class="nav-item nav-mod" onclick="goPage('T-1')"><div class="dot violet"></div>M√≥dulo 1</button>
      <button class="nav-item nav-mod" onclick="goPage('T-2')"><div class="dot violet"></div>M√≥dulo 2</button>
      <button class="nav-item nav-mod" onclick="goPage('T-3')"><div class="dot violet"></div>M√≥dulo 3</button>
      <button class="nav-item nav-mod" onclick="goPage('T-4')"><div class="dot violet"></div>M√≥dulo 4</button>
    </div>
    <div class="nav-section"><div class="nav-label">Individual</div>
      <button class="nav-item" onclick="goPage('personalizados')"><div class="dot teal"></div> Clases Personalizadas</button>
    </div>
    <div class="sidebar-footer"><button class="btn btn-green" style="width:100%" onclick="exportarTodo()">‚¨áÔ∏è Exportar Excel</button></div>
  </nav>

  <!-- Content -->
  <div class="content">
    <div class="topbar">
      <button class="hamburger" onclick="toggleSidebar()" title="Men√∫">‚ò∞</button>
      <div class="topbar-title" id="topbarTitle">Resumen General</div>
      <div id="syncIndicator"></div>
      <button class="btn btn-outline" onclick="showCloudConfig()" title="Configurar Google Sheets">‚òÅÔ∏è Sheets</button>
      <div class="topbar-date" id="topbarDate"></div>
    </div>
    <!-- Dashboard -->
    <div class="page active" id="page-dashboard">
      <div class="stats-grid">
        <div class="stat"><div class="v amber" id="d-total">0</div><div class="l">Alumnos totales</div></div>
        <div class="stat"><div class="v green" id="d-pres">0</div><div class="l">Presentes hoy</div></div>
        <div class="stat"><div class="v red" id="d-falt">0</div><div class="l">Faltas hoy</div></div>
        <div class="stat"><div class="v yellow" id="d-alert">0</div><div class="l">Con alertas</div></div>
        <div class="stat"><div class="v blue" id="d-pers">0</div><div class="l">Personalizados</div></div>
      </div>
      <div class="dash-grid" id="dashCards"></div>
    </div>
    <!-- M√≥dulos y personalizados se generan din√°micamente -->
    <div class="page" id="page-personalizados">
      <!-- Formulario y listado de personalizados -->
    </div>
  </div>
</div>

<div class="toast" id="toast"></div>
<div class="overlay" id="overlay">
  <div class="modal" id="modalBox">
    <h3 id="mTitle"></h3><p id="mBody"></p><div id="mExtra"></div>
    <div class="modal-btns">
      <button class="btn btn-outline" onclick="closeModal()">Cancelar</button>
      <button class="btn btn-amber" id="mOk">Confirmar</button>
    </div>
  </div>
</div>

<script>
// Aqu√≠ van todos los scripts que me enviaste: manejo de state, renderizado, import/export Excel, sync con Sheets.
// Mejoras: cloudLoad() y initData() aseguran que al recargar se restauren datos desde Sheets o localStorage.
</script>

</body>
</html>
